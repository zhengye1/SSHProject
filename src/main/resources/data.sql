-- MySQL Script generated by MySQL Workbench
-- 05/04/16 21:46:08
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema SSMDB
-- -----------------------------------------------------
-- This is SSMDB

-- -----------------------------------------------------
-- Schema SSMDB
--
-- This is SSMDB
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `SSMDB` DEFAULT CHARACTER SET utf8 COLLATE utf8_icelandic_ci ;
USE `SSMDB` ;

-- -----------------------------------------------------
-- Table `SSMDB`.`Department`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `SSMDB`.`Department` ;

CREATE TABLE IF NOT EXISTS `SSMDB`.`Department` 
(
  depId INT NOT NULL,
  name VARCHAR(255) NOT NULL,
  PRIMARY KEY (depId)
);


-- -----------------------------------------------------
-- Table `SSMDB`.`user`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `SSMDB`.`user` ;

CREATE TABLE IF NOT EXISTS `SSMDB`.`user` (
  `uid` INT NOT NULL,
  `username` varchar(16) NOT NULL COMMENT '',
  `email` varchar(255) NULL COMMENT '',
  `password` VARCHAR(255) NOT NULL COMMENT '',
  `dateOfBirth` DATETIME NULL COMMENT '',
  `firstName` VARCHAR(45) NULL COMMENT '',
  `lastName` VARCHAR(45) NULL COMMENT '',
  `status` VARCHAR(30) NULL COMMENT '',
  `depId` INT NOT NULL COMMENT '',
  PRIMARY KEY (`uid`),
  UNIQUE INDEX `uid_UNIQUE` (`uid` ASC),
  INDEX `fk_user_Department_idx` (`depId` ASC),
  CONSTRAINT `fk_user_Department`
    FOREIGN KEY (`depId`)
    REFERENCES `SSMDB`.`Department` (`depId`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION);


-- -----------------------------------------------------
-- Table `SSMDB`.`ROLE`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `SSMDB`.`ROLE` ;

CREATE TABLE IF NOT EXISTS `SSMDB`.`ROLE` (
  `rid` INT NOT NULL COMMENT '',
  `RoleName` VARCHAR(45) NOT NULL COMMENT '',
  PRIMARY KEY (`rid`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `SSMDB`.`USERROLE`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `SSMDB`.`USERROLE` ;

CREATE TABLE IF NOT EXISTS `SSMDB`.`USERROLE` (
  `ROLE_rid` INT NOT NULL COMMENT '',
  `user_uid` INT NOT NULL COMMENT '',
  INDEX `fk_USERROLE_ROLE1_idx` (`ROLE_rid` ASC) ,
  INDEX `fk_USERROLE_user1_idx` (`user_uid` ASC),
  PRIMARY KEY (`ROLE_rid`, `user_uid`) ,
  CONSTRAINT `fk_USERROLE_ROLE1`
    FOREIGN KEY (`ROLE_rid`)
    REFERENCES `SSMDB`.`ROLE` (`rid`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_USERROLE_user1`
    FOREIGN KEY (`user_uid`)
    REFERENCES `SSMDB`.`user` (`uid`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;

-- -------------------------
-- Inserting data
-- -------------------------
insert into department(depId, name) values(1, 'ADMIN');
insert into department(depId, name) values(2, 'TA');
insert into department(depId, name) values(3, 'TK');
insert into department(depId, name) values(4, 'TB');
insert into department(depId, name) values(5, 'T4');
insert into department(depId, name) values(6, 'T8');

insert into role(rid, rolename) values(1, 'ADMIN');
insert into role(rid, rolename) values(2, 'LEADER');
insert into role(rid, rolename) values(3, 'MEMBER');

insert into user(uid, username, email, password, dateOfBirth, firstName, lastName, status, depId) values(1, 'admin', 'admin@admin.com',  'admin', date('1990-12-01'), 'Admin', 'Admin', 'Active', 1);
insert into userrole(role_rid, user_uid) values(1, 1); 

-- Leader
insert into user(uid, username, email, password, dateOfBirth, firstName, lastName, status, depId) values(2, 'yui.yokoyama', 'yui.yokoyama@akb.co.jp',  'yui91228', date('1992-12-28'), 'Yui', 'Yokoyama', 'Active', 2);
insert into user(uid, username, email, password, dateOfBirth, firstName, lastName, status, depId) values(3, 'minami.minegishi', 'minami.minegishi@akb.co.jp',  'minami980129', date('1998-01-29'), 'Minami', 'Minegishi', 'Active', 3);
insert into user(uid, username, email, password, dateOfBirth, firstName, lastName, status, depId) values(4, 'yuria.kizaki', 'yuria.kizaki@akb.co.jp',  'yuria960211', date('1996-02-11'), 'Yuria', 'Kizaki', 'Active', 4);
insert into user(uid, username, email, password, dateOfBirth, firstName, lastName, status, depId) values(5, 'juri.takahashi', 'juri.takahashi@akb.co.jp',  'juri971003', date('1997-10-03'), 'Juria', 'Takahashi', 'Active', 5);
insert into user(uid, username, email, password, dateOfBirth, firstName, lastName, status, depId) values(6, 'ikumi.nakano', 'ikumi.nakano@akb.co.jp',  'ikumi20000820', date('2000-08-20'), 'Ikumi', 'Nakano', 'Active', 6);

-- Member
insert into user(uid, username, email, password, dateOfBirth, firstName, lastName, status, depId) values(7, 'sakura.miyawaki', 'sakura.miyawaki@akb.co.jp',  'sakura980319', date('1998-03-19'), 'Sakura', 'Miyawaki', 'Active', 2);
insert into user(uid, username, email, password, dateOfBirth, firstName, lastName, status, depId) values(8, 'haruka.kodama', 'haruka.kodama@akb.co.jp',  'haruka960619', date('1996-06-19'), 'Haruka', 'Kodama', 'Active', 3);
insert into user(uid, username, email, password, dateOfBirth, firstName, lastName, status, depId) values(9, 'yuki.kashiwagi', 'yuki.kashiwagi@akb.co.jp',  'yukirin0715', date('1991-07-15'), 'Yukirin', 'Kashiwagi', 'Active', 4);
insert into user(uid, username, email, password, dateOfBirth, firstName, lastName, status, depId) values(10, 'saho.iwata', 'saho.iwata@akb.co.jp',  'saho941004', date('1994-10-04'), 'Saho', 'Iwata', 'Active', 5);
insert into user(uid, username, email, password, dateOfBirth, firstName, lastName, status, depId) values(11, 'yui.yokoyama1', 'yui.yokoyama1@akb.co.jp',  'yui010222', date('2001-02-22'), 'Yui', 'Yokoyama', 'Active', 6);

insert into userrole(role_rid, user_uid) values
(2, 2),
(2, 3),
(2, 4),
(2, 5),
(2, 6),
(3, 2),
(3, 3),
(3, 4),
(3, 5),
(3, 6),
(3, 7),
(3, 8),
(3, 9),
(3, 10),
(3, 11);

-- Persistent table for remember me token
CREATE TABLE persistent_logins (
    username varchar(64) not null,
    series varchar(64) not null,
    token varchar(64) not null,
    last_used timestamp not null,
    PRIMARY KEY (series)
);